## 网络请求方式

### 目录

* 1.HttpClient
* 2.HttpURLConnection
* 3.Volley
* 4.OkHttp+Retrofit

### 1.HttpClient

是什么：Android SDK中包含了这个接口。Apache接口，Apache组织提供的HTTP网络访问接口，实现类是DefaultHttpClient。调用API可以方便进行HTTP请求。

怎么样：Android 6.0版本因为其api众多，对网络请求的封装很彻底，很难在不破坏兼容性的情况下对其进行扩展，所以Android 团队 6.0将其删除。如果要使用，在build.gradle中加入如下代码：
```
android {
    useLibrary 'org.apache.http.legacy'
}
```
代码：HttpClientDemo，HttpClientDemo2

### 2.HttpURLConnection

是什么：Android SDK中包含了这个接口。标准Java接口。可以实现简单的基于URL的请求、响应功能。

怎么样：2.2及之前版本，存在bug。对一个可读的InputStream调用close方法时，可能会导致连接池失效。解决办法：禁用连接池，代码如下。所以2.2及之前，用HttpClient；2.3及之后，用HttpURLConnection。
```
private void disableConnectionReuseIfNecessary() {
        if (Integer.parseInt(Build.VERSION.SDK) < Build.VERSION_CODES.FROYO) {
            System.setProperty("http.keepAlive", "false");
        }
    }
```
代码：HttpUrlConnDemo

用途/后果：

优点：

* API简单，体积较小，所以非常适用于Android项目，容易扩展。
* 压缩和缓存机制可以有效减少网络访问的流量，在提升速度和省电方面可以起到较大的作用。

**问题1：HttpClient和HttpURLConnection：为什么要在子线程中开启网络请求**

因为网络请求是耗时操作，在主线程中进行网络请求如果被其它请求打断，会造成ANR应用无响应，所以开启子线程。子线程请求完得到数据后再通过Handler把内容显示在主线程页面。

**问题2：HttpClient和HttpURLConnection：使用和区别**

链接：https://www.cnblogs.com/genggeng/p/10093479.html

### 3.Volley

是什么：第三方网络请求框架，需要添加依赖或导包。2013年Google I/O大会上推出的网络通信框架Volley即Google开源库Volley，是一个HTTP库。

怎么样：

原理：

- Volley网络请求是基于请求队列的，开发者把请求放在请求队列中，请求队列会依次进行请求。网络请求不是很频繁的话，一个请求队列Application即可，网络请求多的话，一个Activity对应一个请求队列。
- Volley网络请求是在主线程中进行的，内部封装了子线程进行网络请求并把结果返回到了主线程，最后在主线程中把结果展示到页面上。

代码：VolleyDemo。请求封装：VolleyRequest。

用途/后果：

优点：访问网络获取数据，加载图片，性能方面进行了大幅度调整。使请求网络更容易，更快。适合数据量不大但通信频繁的网络操作。
缺点：不适合大数据量如大型下载文件或流式传输的网络操作。因为Volley在解析期间会将所有响应都保存在内存中。对于大型下载操作，请考虑使用替代方法DownloadManager。

### 4.OkHttp

是什么：第三方网络请求框架，需要导包。

快问快答：

1.上述四种网络请求方式的区别：

2.get请求和post请求的区别：

get请求：参数暴露在URL中，不安全，URL长度有限制(必须在2048字符之内，HTTP1.1后没有了限制)。

post请求：参数放在请求数据中，比较安全。






